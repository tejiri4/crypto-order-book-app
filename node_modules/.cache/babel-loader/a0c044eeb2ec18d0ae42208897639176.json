{"ast":null,"code":"import _slicedToArray from \"/Users/tejirimatthew/crypto-order-book-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/tejirimatthew/crypto-order-book-app/src/App.js\";\nimport React, { Component } from 'react';\nimport { Dropdown } from 'semantic-ui-react';\nimport './App.scss';\nimport Table from './components/Table/index';\nimport 'semantic-ui-css/semantic.min.css';\nimport HighestBid from './components/HighestBid/index';\nimport makeRequest from './utils/axiosSetup';\nimport webSocketSetup from './utils/webSocketSetup';\nimport HighestArrayValue from './utils/HighestArrayValue';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      currencyPairs: [],\n      selectedCurrencyDetails: {\n        currencyPair: '',\n        currencyNameArr: []\n      },\n      liveBookDatas: {},\n      isLoading: true,\n      highestBid: [],\n      highestAsk: [],\n      subscribe: false\n    };\n\n    this.handleStreamResponse = ({\n      data: liveBookDatas\n    }) => {\n      console.log(liveBookDatas);\n\n      if (this.state.subscribe) {\n        const highestBid = HighestArrayValue(liveBookDatas, 'bids');\n        const highestAsk = HighestArrayValue(liveBookDatas, 'asks');\n        this.setState({\n          liveBookDatas,\n          highestBid,\n          highestAsk\n        });\n      }\n    };\n\n    this.handleDropdownChange = async (event, data) => {\n      console.log(this.state.selectedCurrencyDetails.currencyPair, 'state');\n\n      const _data$value$split = data.value.split(' '),\n            _data$value$split2 = _slicedToArray(_data$value$split, 2),\n            currencyName = _data$value$split2[0],\n            currencyPair = _data$value$split2[1];\n\n      await webSocketSetup({\n        text: 'unsubscribe',\n        currencyPair: this.state.selectedCurrencyDetails.currencyPair\n      }); // this.setState({\n      //   selectedCurrencyDetails: {\n      //     currencyPair,\n      //     currencyNameArr: currencyName.replace('/', ' ').split(' ')\n      //   },\n      //   liveBookDatas: {},\n      //   highestBid: [],\n      //   highestAsk: [],\n      //   subscribe: false\n      // })\n      // await webSocketSetup({\n      //   subscribe: true,\n      //   currencyPair,\n      //   callBack: this.handleStreamResponse\n      // })\n    };\n  }\n\n  async componentDidMount() {\n    let currencyPairs = await makeRequest('https://www.bitstamp.net/api/v2/trading-pairs-info/');\n    currencyPairs = currencyPairs.map(({\n      url_symbol,\n      description,\n      name\n    }) => ({\n      key: url_symbol,\n      text: description,\n      value: \"\".concat(name, \" \").concat(url_symbol)\n    }));\n\n    const _currencyPairs$0$valu = currencyPairs[0].value.split(' '),\n          _currencyPairs$0$valu2 = _slicedToArray(_currencyPairs$0$valu, 2),\n          currencyName = _currencyPairs$0$valu2[0],\n          currencyPair = _currencyPairs$0$valu2[1];\n\n    this.setState({\n      currencyPairs,\n      selectedCurrencyDetails: {\n        currencyPair,\n        currencyNameArr: currencyName.replace('/', ' ').split(' ')\n      },\n      isLoading: false,\n      subscribe: true\n    });\n    console.log('component did mount');\n    webSocketSetup({\n      text: 'subscribe',\n      currencyPair,\n      callBack: this.handleStreamResponse\n    });\n    setTimeout(() => {\n      console.log('have unsubscribe');\n      webSocketSetup({\n        text: 'unsubscribe',\n        currencyPair,\n        callBack: this.handleStreamResponse\n      });\n    }, 10000);\n  }\n\n  render() {\n    const _this$state = this.state,\n          currencyPairs = _this$state.currencyPairs,\n          currencyNameArr = _this$state.selectedCurrencyDetails.currencyNameArr,\n          liveBookDatas = _this$state.liveBookDatas,\n          highestBid = _this$state.highestBid,\n          highestAsk = _this$state.highestAsk;\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, \"Crpto App\"), React.createElement(\"div\", {\n      className: \"top\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"width-fifty-percent\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"top-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, currencyNameArr.length && \"Highest  \".concat(currencyNameArr[0], \" - \").concat(currencyNameArr[1], \" Exchange\")), React.createElement(HighestBid, {\n      bidTitle: \"Bid\",\n      currencyNameArr: currencyNameArr,\n      highestBidAskArr: highestBid,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }), React.createElement(HighestBid, {\n      bidTitle: \"Ask\",\n      currencyNameArr: currencyNameArr,\n      highestBidAskArr: highestAsk,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"width-fifty-percent\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(Dropdown, {\n      placeholder: \"\".concat(currencyPairs.length ? currencyPairs[0].text : 'Select an option'),\n      selection: true,\n      options: this.state.currencyPairs,\n      onChange: this.handleDropdownChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"table-collection\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(Table, {\n      bidTitle: \"Bid\",\n      currencyNameArr: currencyNameArr,\n      contentArr: liveBookDatas.bids ? liveBookDatas.bids : [],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }), React.createElement(Table, {\n      bidTitle: \"Asks\",\n      currencyNameArr: currencyNameArr,\n      contentArr: liveBookDatas.asks ? liveBookDatas.asks : [],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/tejirimatthew/crypto-order-book-app/src/App.js"],"names":["React","Component","Dropdown","Table","HighestBid","makeRequest","webSocketSetup","HighestArrayValue","App","state","currencyPairs","selectedCurrencyDetails","currencyPair","currencyNameArr","liveBookDatas","isLoading","highestBid","highestAsk","subscribe","handleStreamResponse","data","console","log","setState","handleDropdownChange","event","value","split","currencyName","text","componentDidMount","map","url_symbol","description","name","key","replace","callBack","setTimeout","render","length","bids","asks"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Dropdown } from 'semantic-ui-react';\nimport './App.scss';\nimport Table from './components/Table/index';\nimport 'semantic-ui-css/semantic.min.css';\nimport HighestBid from './components/HighestBid/index';\nimport makeRequest from './utils/axiosSetup';\nimport webSocketSetup from './utils/webSocketSetup';\nimport HighestArrayValue from './utils/HighestArrayValue';\n\nclass App extends Component {\n  state = {\n    currencyPairs: [],\n    selectedCurrencyDetails: {\n      currencyPair: '',\n      currencyNameArr: []\n    },\n    liveBookDatas: {},\n    isLoading: true,\n    highestBid: [],\n    highestAsk: [],\n    subscribe: false\n  }\n\n  async componentDidMount() {\n    let currencyPairs = await makeRequest('https://www.bitstamp.net/api/v2/trading-pairs-info/');\n    currencyPairs = currencyPairs.map(({ url_symbol, description, name }) => ({\n      key: url_symbol,\n      text: description,\n      value: `${name} ${url_symbol}`\n    }));\n    const [currencyName, currencyPair] = currencyPairs[0].value.split(' ')\n    this.setState({\n      currencyPairs, selectedCurrencyDetails: {\n        currencyPair,\n        currencyNameArr: currencyName.replace('/', ' ').split(' ')\n      },\n      isLoading: false,\n      subscribe: true\n    })\n\n    console.log('component did mount');\n    \n    webSocketSetup({\n      text: 'subscribe',\n      currencyPair,\n      callBack: this.handleStreamResponse\n    })\n    setTimeout(() => {\n      console.log('have unsubscribe')\n      webSocketSetup({\n        text: 'unsubscribe',\n        currencyPair,\n        callBack: this.handleStreamResponse\n      })\n    }, 10000)\n\n\n  }\n\n  handleStreamResponse = ({ data: liveBookDatas }) => {\n    console.log(liveBookDatas);\n\n    if (this.state.subscribe) {\n      const highestBid = HighestArrayValue(liveBookDatas, 'bids');\n      const highestAsk = HighestArrayValue(liveBookDatas, 'asks');\n      this.setState({ liveBookDatas, highestBid, highestAsk })\n    }\n  }\n\n  handleDropdownChange = async (event, data) => {\n    console.log(this.state.selectedCurrencyDetails.currencyPair, 'state');\n\n    const [currencyName, currencyPair] = data.value.split(' ');\n    await webSocketSetup({\n      text: 'unsubscribe',\n      currencyPair: this.state.selectedCurrencyDetails.currencyPair\n    })\n    // this.setState({\n    //   selectedCurrencyDetails: {\n    //     currencyPair,\n    //     currencyNameArr: currencyName.replace('/', ' ').split(' ')\n    //   },\n    //   liveBookDatas: {},\n    //   highestBid: [],\n    //   highestAsk: [],\n    //   subscribe: false\n    // })\n    // await webSocketSetup({\n    //   subscribe: true,\n    //   currencyPair,\n    //   callBack: this.handleStreamResponse\n    // })\n  }\n\n  render() {\n    const { currencyPairs, selectedCurrencyDetails: { currencyNameArr }, liveBookDatas, highestBid, highestAsk } = this.state;\n    return (\n      <div className=\"App\">\n        <div className='header'>Crpto App</div>\n        <div className='top'>\n          <div className='width-fifty-percent'>\n            <div className='top-left'>\n              <h2>{currencyNameArr.length && `Highest  ${currencyNameArr[0]} - ${currencyNameArr[1]} Exchange`}</h2>\n              <HighestBid bidTitle='Bid' currencyNameArr={currencyNameArr} highestBidAskArr={highestBid} />\n              <HighestBid bidTitle='Ask' currencyNameArr={currencyNameArr} highestBidAskArr={highestAsk} />\n            </div>\n          </div>\n          <div className='width-fifty-percent'>\n            <Dropdown\n              placeholder={`${currencyPairs.length ? currencyPairs[0].text : 'Select an option'}`}\n              selection options={this.state.currencyPairs}\n              onChange={this.handleDropdownChange}\n            />\n          </div>\n        </div>\n        <div className='table-collection'>\n          <Table bidTitle='Bid' currencyNameArr={currencyNameArr} contentArr={liveBookDatas.bids ? liveBookDatas.bids : []} />\n          <Table bidTitle='Asks' currencyNameArr={currencyNameArr} contentArr={liveBookDatas.asks ? liveBookDatas.asks : []} />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}